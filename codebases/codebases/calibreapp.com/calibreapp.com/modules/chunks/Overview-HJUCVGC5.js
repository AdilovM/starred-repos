import{a as vo}from"./chunk-BGUAJZU5.js";import{a as po,b as go,e as fo}from"./chunk-JVL6PN7W.js";import{a as j,b as yo}from"./chunk-EKOJVSNL.js";import{a as lo}from"./chunk-KCN7NYIH.js";import"./chunk-YG5VU5UW.js";import"./chunk-DQSCGVX4.js";import{b as So,c as Bo}from"./chunk-QZKSC5M6.js";import"./chunk-CWNFCDZO.js";import"./chunk-ZMOXJOAW.js";import{a as mo,b as uo}from"./chunk-JLSB3ZPE.js";import"./chunk-DGXX4BQF.js";import{a as so}from"./chunk-IHTWZOQH.js";import"./chunk-OFY5O3WH.js";import"./chunk-WDJIMBUZ.js";import"./chunk-ZK4YBVUK.js";import"./chunk-URMVBSCF.js";import{h as z}from"./chunk-CEAYBKHZ.js";import{a as Y}from"./chunk-RZQ4QVPP.js";import"./chunk-M3VXQ3H4.js";import{a as ao}from"./chunk-UJ4RDOBF.js";import{a as L,b as H}from"./chunk-EWS3NXQH.js";import{c as I,d as A,i as G}from"./chunk-AQDAG4C2.js";import{a as no,b as K,c as ro,d as io,e as to,f as eo}from"./chunk-TT3E6PQD.js";import{a as R,b as oo,i as E}from"./chunk-WNVFIGRJ.js";import"./chunk-BYK2LYTJ.js";import"./chunk-SOUDSSPT.js";import"./chunk-YN3ICWDL.js";import{b as $,f as v,i as P}from"./chunk-JXNVBN57.js";import"./chunk-4JRWSVEX.js";import{b as k,c as q}from"./chunk-FJD4SS3V.js";import"./chunk-TKNWVBCA.js";import"./chunk-V454E5QD.js";import{h as X}from"./chunk-4DDSFSZM.js";import{a as _}from"./chunk-M5TAP4VX.js";import"./chunk-X4YGTLGV.js";import"./chunk-BBW4QHNN.js";import{b as Z,d as s,e as B}from"./chunk-CL7MNENB.js";import"./chunk-5ZVMZG6E.js";import"./chunk-33HWVBTX.js";import{a as O,b as Q,f as U,i as c}from"./chunk-ORNWO27Z.js";var h=U(c());var f=U(c());var o=U(c());var ho=({status:u,periodEndAt:r,name:l,amount:a,interval:g,currency:y,tagged:m,testPack:i,userPack:e})=>{let D=r&&j(r),T=r&&yo(r),b=((a||0)+((i==null?void 0:i.quantity)?i.quantity*i.amount:0)+((e==null?void 0:e.quantity)?e.quantity+e.amount:0))/100;return m.includes("enterprise")?o.default.createElement(o.default.Fragment,null,o.default.createElement(s,{id:"organisations.plan.summary.enterprise",values:{name:o.default.createElement(o.default.Fragment,null,"a custom ",o.default.createElement(v,null,"Enterprise Plan"))}})):m.includes("company")?o.default.createElement(o.default.Fragment,null,o.default.createElement(s,{id:"organisations.plan.summary.company",values:{name:o.default.createElement(o.default.Fragment,null,"a ",o.default.createElement(v,null,"Company Plan"))}})):u==="trialing"?o.default.createElement(s,{id:"organisations.plan.summary.trialing",values:{name:o.default.createElement(v,null,"Trial"),daysRemaining:o.default.createElement(v,null,T),periodEndAt:D?o.default.createElement(o.default.Fragment,null," on ",o.default.createElement(v,null,D)):null}}):u==="active"?o.default.createElement(o.default.Fragment,null,o.default.createElement(s,{id:"organisations.plan.summary.active",values:{name:o.default.createElement(v,null,l," Plan")}})," ",(i==null?void 0:i.quantity)||(e==null?void 0:e.quantity)?o.default.createElement(s,{id:"organisations.plan.summary.packs"}):o.default.createElement(o.default.Fragment,null,"It\u2019s"," ",o.default.createElement(v,null,o.default.createElement(B,{value:b,style:"currency",currency:y,minimumFractionDigits:0})," ","per ",g)),(e==null?void 0:e.quantity)||(i==null?void 0:i.quantity)?o.default.createElement(o.default.Fragment,null,(e==null?void 0:e.quantity)?o.default.createElement(o.default.Fragment,null," ",o.default.createElement(s,{id:"organisations.plan.summary.userPacks",values:{count:e.quantity,pluralize:e.quantity===1?"":"s"}}),(i==null?void 0:i.quantity)?" and ":null):null,(i==null?void 0:i.quantity)?o.default.createElement(o.default.Fragment,null," ",o.default.createElement(s,{id:"organisations.plan.summary.testPacks",values:{count:i.quantity,pluralize:i.quantity===1?"":"s"}})):null,o.default.createElement(o.default.Fragment,null,", it\u2019s"," ",o.default.createElement(v,null,o.default.createElement(B,{value:b,style:"currency",currency:y,minimumFractionDigits:0})," ","per ",g),".")):"."):null};ho.defaultProps={name:"Custom",amount:0,interval:"month",currency:"usd",periodEndAt:null,testPack:{},tagged:""};var bo=ho;var Uo=({slug:u,status:r,plan:l,testPack:a,userPack:g,periodEndAt:y,history:m})=>f.default.createElement(A,null,f.default.createElement(q,null,r?["canceled","trial_expired","trial_canceled","past_due"].includes(r)&&f.default.createElement(vo,{plan:l,status:r,periodEndAt:y,slug:u,isAdmin:!0})||f.default.createElement(bo,Q(O({status:r},l),{periodEndAt:y,testPack:a,userPack:g})):f.default.createElement(L,null)),f.default.createElement(q,{my:3},r?l.tagged.includes("enterprise")?f.default.createElement(f.default.Fragment,null,f.default.createElement($,{as:"p",mb:3},f.default.createElement(s,{id:"organisations.plan.summary.contact"})),f.default.createElement(E,{as:"a",href:"mailto:hello@calibreapp.com",variant:"tertiary"},f.default.createElement(s,{id:"organisations.plan.actions.contact"}))):f.default.createElement(E,{onClick:()=>m.push(`/organisations/${u}/billing/plan`)},f.default.createElement(s,{id:`organisations.plan.actions.${r==="active"?"change":"choose"}`})):f.default.createElement(H,{href:"plan"}))),xo=X(Uo);var n=U(c());var M=U(c());var qo=({summary:u,children:r,onOpen:l})=>{let[a,g]=(0,M.useState)(!1);return(0,M.useEffect)(()=>l&&l(a),[a]),M.default.createElement("details",null,M.default.createElement(oo,{as:"summary",onClick:()=>g(!a),open:a},u),r)};qo.defaultProps={summary:"Details Summary"};var Do=qo;var t=U(c());var co=({orgId:u,attributes:r})=>{let[l,a]=(0,t.useState)(r[0]),[g,y]=(0,t.useState)("asc"),{data:m,loading:i}=_(go,{variables:{organisation:u},fetchPolicy:"cache-and-network"}),{organisation:e}=m||{},{subscription:D}=e||{},{testAllocation:T}=D||{},{sites:b}=T||{},w=(b||[]).map(({site:{name:p,slug:d,estimatedTestsPerMonth:N,scheduleInterval:C,scheduleAnchor:wo,team:x},team:S,snapshot:V,reviewSite:W})=>{let J=(x==null?void 0:x.slug)===(S==null?void 0:S.slug)&&C?C:"off";return{name:{value:p,label:!(d==null?void 0:d.length)||(S==null?void 0:S.slug)===(x==null?void 0:x.slug)?p:t.default.createElement(s,{id:"organisations.usage.sites.moved",values:{name:p,team:(x==null?void 0:x.name)||"Team"}})},team:{value:S==null?void 0:S.name,label:S==null?void 0:S.name},schedule:{value:J,label:t.default.createElement(s,{id:`organisations.usage.sites.scheduleInterval.${J}`,values:{anchor:wo}})},snapshot:{value:V,label:t.default.createElement(t.default.Fragment,null,t.default.createElement(B,{value:V})," ",J==="off"?null:t.default.createElement(P,{level:"xs"},t.default.createElement(s,{id:"organisations.usage.sites.estimate",values:{estimate:t.default.createElement(B,{value:N||0})}})))},reviewSite:{value:W,label:t.default.createElement(t.default.Fragment,null,t.default.createElement(B,{value:W}))}}}).slice().sort((p,d)=>["name","team","schedule"].includes(l)?mo(p[l].value,d[l].value,g):uo(p[l].value,d[l].value,g));return i?t.default.createElement(L,{width:"100%"}):t.default.createElement(eo,{overflow:"auto"},t.default.createElement(no,null,t.default.createElement(K,null,r.map((p,d)=>t.default.createElement(io,{key:p,px:0,width:`${d===r.length-1?5:95/r.length}%`,textAlign:"left"},t.default.createElement(R,{attribute:p,onUpdateSortBy:a,onUpdateSortDirection:y,sortBy:l,sortDirection:g},t.default.createElement(s,{id:`organisations.usage.sites.${p}`})))))),t.default.createElement(to,null,w.length&&w.map((p,d)=>t.default.createElement(K,{key:d},r.map((N,C)=>t.default.createElement(ro,{key:`${d}-${C}`,px:0,textAlign:"left"},p[N].label))))))},To=co;var Mo=({orgId:u,loading:r,status:l,periodEndAt:a,estimatedTestsPerMonth:g,total:y,allotment:m,snapshot:i,singlePage:e})=>{let[D,T]=(0,n.useState)(!1),b=Z(),w=[{name:"Snapshots",value:i,scaled:m?i/m*100:0,color:z.colors.blue300,label:" ",formatted:b.formatNumber(i)},{name:"Single Page Tests",value:e,scaled:m?e/m*100:0,color:z.colors.red300,label:" ",formatted:b.formatNumber(e)},{value:m-y,scaled:m?(m-y)/m*100:100,color:z.colors.grey100}],p=["team","name","schedule","snapshot","reviewSite"];return n.default.createElement(A,null,n.default.createElement(G,{id:"organisations.usage"}),n.default.createElement(q,{mb:3},r?n.default.createElement(L,null):["canceled","trial_canceled","trial_expired"].includes(l)?null:n.default.createElement($,null,n.default.createElement(s,{id:"organisations.tests.allocation",values:{date:j(a)}}))),n.default.createElement(k,{mb:"15px"},n.default.createElement(q,{flex:1},r?n.default.createElement(L,null):n.default.createElement($,{level:"xs"},n.default.createElement(s,{id:"organisations.tests.usage",values:{total:n.default.createElement(v,null,n.default.createElement(B,{value:y})),allotment:n.default.createElement(v,null,n.default.createElement(B,{value:m})),estimated:n.default.createElement(v,null,n.default.createElement(B,{value:g}))}}))),n.default.createElement(q,null,n.default.createElement(So,{series:w.filter(d=>d.name)}))),n.default.createElement(q,{mb:"15px"},n.default.createElement(Bo,{level:"xs",segments:w})),n.default.createElement(q,null,n.default.createElement(s,{id:`organisations.usage.${p.includes("team")?"siteAndTeam":"site"}`},d=>n.default.createElement(Do,{summary:d,onOpen:T},D?n.default.createElement(To,{orgId:u,attributes:p}):n.default.createElement(L,null)))))},Lo=Mo;var F=U(c());var Co=({name:u,onDelete:r,loading:l,saving:a})=>F.default.createElement(A,null,F.default.createElement(G,{id:"organisations.delete",link:"/docs/account-and-billing/cancel-account"}),F.default.createElement(I,null,l?F.default.createElement(H,null):F.default.createElement(s,{id:"organisations.delete.prompt",values:{name:u}},g=>F.default.createElement(E,{variant:"danger",disabled:a,onClick:()=>{prompt(g)===u&&r()},loading:a},F.default.createElement(s,{id:"organisations.actions.delete"}))))),Fo=Co;var Oo=({match:{params:{orgId:u}}})=>{let[r,l]=(0,h.useState)({}),a={organisation:u},{data:g,loading:y}=_(po,{variables:a,fetchPolicy:"cache-and-network"}),[m,{loading:i}]=Y(fo,{onCompleted:()=>window.location="/home",onError:C=>{l({type:"error",message:so(C)})}}),e=()=>m({variables:a}),{organisation:D}=g||{},{subscription:T,name:b,slug:w,estimatedTestsPerMonth:p}=D||{},{status:d,testAllocation:N}=T||{};return h.default.createElement(h.default.Fragment,null,h.default.createElement(ao,{id:"organisations.overview.title",breadcrumbs:[b]}),h.default.createElement(I,null,!r.type||h.default.createElement(lo,O({p:0,pt:4,px:4,duration:0,onDismiss:()=>l({})},r)),h.default.createElement(xo,O({slug:w},T||{})),h.default.createElement(Lo,Q(O({orgId:u,status:d},N||{}),{estimatedTestsPerMonth:p,loading:y})),h.default.createElement(Fo,{name:b,onDelete:e,loading:y,saving:i})))},Cn=Oo;export{Cn as default};
//# sourceMappingURL=Overview-HJUCVGC5.js.map
