import{a as ne}from"./chunk-YG5VU5UW.js";import{a as ie}from"./chunk-IHTWZOQH.js";import"./chunk-OFY5O3WH.js";import{c as o,e as a,f as b}from"./chunk-ECKCXZDJ.js";import"./chunk-5AD3ZUGZ.js";import"./chunk-2OWL4LTV.js";import"./chunk-62V4AEVH.js";import"./chunk-WDJIMBUZ.js";import"./chunk-ZK4YBVUK.js";import"./chunk-URMVBSCF.js";import{a as J}from"./chunk-RZQ4QVPP.js";import"./chunk-M3VXQ3H4.js";import{a as te}from"./chunk-UJ4RDOBF.js";import{a as ee}from"./chunk-EWS3NXQH.js";import{d as Y,e as Z,i as P}from"./chunk-AQDAG4C2.js";import"./chunk-TT3E6PQD.js";import{i as D}from"./chunk-WNVFIGRJ.js";import"./chunk-BYK2LYTJ.js";import"./chunk-SOUDSSPT.js";import"./chunk-YN3ICWDL.js";import{f as R,h as N}from"./chunk-JXNVBN57.js";import"./chunk-4JRWSVEX.js";import{b as E,c as x}from"./chunk-FJD4SS3V.js";import"./chunk-TKNWVBCA.js";import"./chunk-V454E5QD.js";import"./chunk-4DDSFSZM.js";import{a as K}from"./chunk-M5TAP4VX.js";import"./chunk-X4YGTLGV.js";import"./chunk-BBW4QHNN.js";import{b as X,d as y}from"./chunk-CL7MNENB.js";import"./chunk-5ZVMZG6E.js";import"./chunk-33HWVBTX.js";import{a as c,b as _,c as h,f as C,i as L}from"./chunk-ORNWO27Z.js";var d=C(L());var n=C(L());var e=C(L());var re=p=>{var r=p,{loading:s,saving:l,onUpdate:g,onCancel:k}=r,u=h(r,["loading","saving","onUpdate","onCancel"]);let S=(0,e.useRef)(),[V,F]=(0,e.useState)(!1),[f,T]=(0,e.useState)(u);(0,e.useEffect)(()=>{T(u)},[s]),(0,e.useEffect)(()=>{F(l)},[l]);let G=t=>{t.preventDefault(),g(f)},v=t=>{let H=c(c({},f),t);T(H),F(!0)},{url:M,formSelector:U,username:A,usernameSelector:O,password:w,passwordSelector:q,buttonSelector:$}=f;return e.default.createElement("form",{onSubmit:G,ref:S},e.default.createElement(o,{mb:0},e.default.createElement(a,{span:2,labelid:"site.settings.authentication.url.label",helpid:"site.settings.authentication.url.help"},e.default.createElement(b,{"data-testid":"authentication-settings-url",name:"url",type:"url",loading:s,defaultValue:M,onChange:t=>v({url:t}),maxLength:255,required:!0}))),e.default.createElement(o,{mb:0},e.default.createElement(a,{labelid:"site.settings.authentication.username.label"},e.default.createElement(b,{"data-testid":"authentication-settings-username",name:"username",loading:s,defaultValue:A,onChange:t=>v({username:t}),maxLength:255})),e.default.createElement(a,{labelid:"site.settings.authentication.password.label"},e.default.createElement(b,{"data-testid":"authentication-settings-password",name:"password",type:"password",loading:s,defaultValue:w,onChange:t=>v({password:t}),maxLength:255,required:!0}))),e.default.createElement(o,{mb:0},e.default.createElement(a,{label:"Form selector",labelid:"site.settings.authentication.formSelector.label",helpid:"site.settings.authentication.formSelector.help"},e.default.createElement(b,{"data-testid":"authentication-settings-form-selector",name:"form-selector",loading:s,placeholder:"#sign-in",defaultValue:U,onChange:t=>v({formSelector:t}),maxLength:255,required:!0})),e.default.createElement(a,{labelid:"site.settings.authentication.buttonSelector.label",helpid:"site.settings.authentication.buttonSelector.help"},e.default.createElement(b,{"data-testid":"authentication-settings-button-selector",name:"button-selector",loading:s,placeholder:'input[type="submit"]',defaultValue:$,onChange:t=>v({buttonSelector:t}),maxLength:255}))),e.default.createElement(o,{mb:0},e.default.createElement(a,{labelid:"site.settings.authentication.usernameSelector.label"},e.default.createElement(b,{"data-testid":"authentication-settings-username-selector",name:"username-selector",loading:s,placeholder:'input[name="username"]',defaultValue:O,onChange:t=>v({usernameSelector:t}),maxLength:255})),e.default.createElement(a,{labelid:"site.settings.authentication.passwordSelector.label"},e.default.createElement(b,{"data-testid":"authentication-settings-password-selector",name:"password-selector",loading:s,placeholder:'input[name="password"]',defaultValue:q,onChange:t=>v({passwordSelector:t}),maxLength:255,required:!0}))),e.default.createElement(o,{mb:0},e.default.createElement(a,{span:2},e.default.createElement(ne,{type:"warning"},e.default.createElement(R,{color:"yellow500"},"Credentials will be stored in clear text.")," ","We recommend creating a special test account for Calibre."))),e.default.createElement(E,null,e.default.createElement(x,{order:2},e.default.createElement(D,{"data-testid":"authentication-settings-submit",disabled:!V||l,loading:l,type:"submit"},e.default.createElement(y,{id:"site.actions.update_authentication"}))),k?e.default.createElement(x,{mr:2,order:1},e.default.createElement(D,{"data-testid":"authentication-settings-cancel",onClick:k,variant:"tertiary"},e.default.createElement(y,{id:"site.actions.cancel"}))):null))},ae=re;var i=C(L());var oe=({url:s,username:l,password:g,formSelector:k,buttonSelector:u,usernameSelector:p,passwordSelector:r})=>i.default.createElement(i.default.Fragment,null,i.default.createElement(o,{mb:0},i.default.createElement(a,{span:2,"data-testid":"authentication-settings-url",labelid:"site.settings.authentication.url.label"},i.default.createElement(N,null,s))),i.default.createElement(o,{mb:0},i.default.createElement(a,{"data-testid":"authentication-settings-username",labelid:"site.settings.authentication.username.label"},i.default.createElement(N,null,l||"Not set")),i.default.createElement(a,{"data-testid":"authentication-settings-password",labelid:"site.settings.authentication.password.label"},i.default.createElement(N,null,Array(g?g.length:0).fill("\u2022").join("")))),i.default.createElement(o,{mb:0},i.default.createElement(a,{"data-testid":"authentication-settings-form-selector",labelid:"site.settings.authentication.formSelector.label"},i.default.createElement(N,null,k)),i.default.createElement(a,{"data-testid":"authentication-settings-button-selector",labelid:"site.settings.authentication.buttonSelector.label"},i.default.createElement(N,null,u||"Not set"))),i.default.createElement(o,{mb:0},i.default.createElement(a,{"data-testid":"authentication-settings-username-selector",labelid:"site.settings.authentication.usernameSelector.label"},i.default.createElement(N,null,p||"Not set")),i.default.createElement(a,{"data-testid":"authentication-settings-password-selector",labelid:"site.settings.authentication.passwordSelector.label"},i.default.createElement(N,null,r)))),de=oe;var me=V=>{var F=V,{loading:s,saving:l,onUpdate:g,onDelete:k,onEdit:u,onCancel:p,editing:r}=F,S=h(F,["loading","saving","onUpdate","onDelete","onEdit","onCancel","editing"]);let f="DELETE";return n.default.createElement(n.default.Fragment,null,n.default.createElement(Z,null,n.default.createElement(P,{id:"site.settings.authentication",link:"/docs/get-started/authentication"}),n.default.createElement(P,{id:"site.settings.authentication.form"})),n.default.createElement(Y,null,s?n.default.createElement(ee,null):r?n.default.createElement(ae,c({saving:l,onUpdate:g,onCancel:p},S)):n.default.createElement(n.default.Fragment,null,n.default.createElement(de,c({},S)),n.default.createElement(E,null,n.default.createElement(x,{mr:2},n.default.createElement(y,{id:"site.settings.authentication.delete.prompt",values:{confirmText:f}},T=>n.default.createElement(D,{variant:"danger",onClick:()=>{prompt(T)===f&&k()}},n.default.createElement(y,{id:"site.settings.authentication.actions.delete"})))),n.default.createElement(x,null,n.default.createElement(D,{variant:"tertiary",onClick:u},n.default.createElement(y,{id:"site.settings.authentication.actions.edit"})))))))},se=me;var le={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Get"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"teamId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"siteId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"team"},arguments:[{kind:"Argument",name:{kind:"Name",value:"slug"},value:{kind:"Variable",name:{kind:"Name",value:"teamId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"__typename"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"slug"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"organisation"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"__typename"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"slug"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"name"},arguments:[],directives:[],selectionSet:void 0}]}},{kind:"Field",alias:void 0,name:{kind:"Name",value:"site"},arguments:[{kind:"Argument",name:{kind:"Name",value:"slug"},value:{kind:"Variable",name:{kind:"Name",value:"siteId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"__typename"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"slug"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"authenticationSettings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"required"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"url"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"username"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"password"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"formSelector"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"usernameSelector"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"passwordSelector"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"buttonSelector"},arguments:[],directives:[],selectionSet:void 0}]}}]}}]}}]}}]},ue={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"Update"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"orgId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"siteId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},defaultValue:void 0,directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attributes"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SiteSettingsInput"}}},defaultValue:void 0,directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"updateSiteSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"organisation"},value:{kind:"Variable",name:{kind:"Name",value:"orgId"}}},{kind:"Argument",name:{kind:"Name",value:"site"},value:{kind:"Variable",name:{kind:"Name",value:"siteId"}}},{kind:"Argument",name:{kind:"Name",value:"attributes"},value:{kind:"Variable",name:{kind:"Name",value:"attributes"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"slug"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"authenticationSettings"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:void 0,name:{kind:"Name",value:"required"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"url"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"username"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"password"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"formSelector"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"usernameSelector"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"passwordSelector"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"buttonSelector"},arguments:[],directives:[],selectionSet:void 0},{kind:"Field",alias:void 0,name:{kind:"Name",value:"warningMessage"},arguments:[],directives:[],selectionSet:void 0}]}}]}}]}}]};var ce=d.default.lazy(()=>import("./Feedback-J4FBAYX2.js")),ke=({match:{params:{teamId:s,siteId:l}}})=>{let g=X(),[k,u]=(0,d.useState)(),[p,r]=(0,d.useState)(!1),[S,V]=(0,d.useState)({}),F={teamId:s,siteId:l},{loading:f,data:T}=K(le,{variables:F}),{team:G}=T||{},{site:v,organisation:M}=G||{},{name:U,slug:A}=M||{},{name:O,authenticationSettings:w}=v||{},[q,{loading:$}]=J(ue,{onCompleted:Q=>{var{updateSiteSettings:j}=Q,{authenticationSettings:B}=j,z=B,{warningMessage:m}=z,I=h(z,["warningMessage"]);let W=g.formatMessage({id:"site.settings.authentication.success"});u(m?{type:"warning",message:`${W} ${m}`}:{type:"success",message:W}),r(!p),I.required?V(I):V({})},onError:m=>{u({type:"error",message:ie(m)})}}),t=j=>{var B=j,{username:m,usernameSelector:I}=B,Q=h(B,["username","usernameSelector"]);q({variables:{orgId:A,siteId:l,attributes:{authenticationSettings:_(c({},Q),{username:m||"",usernameSelector:I||"",__typename:void 0,required:!0})}}})},H=()=>{q({variables:{orgId:A,siteId:l,attributes:{authenticationSettings:{required:!1}}}})};return(0,d.useEffect)(()=>{let m={};w&&w.required&&(m=w),V(m),r(!m.required)},[f]),d.default.createElement(d.default.Fragment,null,d.default.createElement(te,{id:"site.settings.authentication.title",breadcrumbs:[O,U]}),!k||d.default.createElement(d.Suspense,{fallback:d.default.createElement("div",null)},d.default.createElement(ce,_(c({},k),{p:null,pt:4,px:4,pb:0,onDismiss:()=>u(null)}))),d.default.createElement(se,_(c({key:`authentication-${S.required}`},S),{editing:p,loading:f,saving:$,onUpdate:t,onDelete:H,onCancel:S.required?()=>r(!1):void 0,onEdit:()=>r(!0)})))},Ue=ke;export{Ue as default};
//# sourceMappingURL=Authentication-OUWFWJ4N.js.map
