import{a as ae,c as le}from"./chunk-AZF7LUDH.js";import{a as me}from"./chunk-HVWSZP6M.js";import{f as ne}from"./chunk-IHNDKV3B.js";import{a as re}from"./chunk-SJXFQYTK.js";import{a as te}from"./chunk-KCN7NYIH.js";import"./chunk-YG5VU5UW.js";import"./chunk-CWNFCDZO.js";import{a as ie}from"./chunk-2LV7R6US.js";import{a as se}from"./chunk-JLSB3ZPE.js";import{a as I}from"./chunk-IHTWZOQH.js";import"./chunk-OFY5O3WH.js";import"./chunk-WEIYGZZI.js";import{c as _}from"./chunk-H7BUDTAB.js";import{a as ee}from"./chunk-INK6RNBJ.js";import{b as R}from"./chunk-5AD3ZUGZ.js";import"./chunk-2OWL4LTV.js";import{a as G}from"./chunk-RZQ4QVPP.js";import{a as oe}from"./chunk-UJ4RDOBF.js";import{d as J}from"./chunk-EWS3NXQH.js";import{j as O}from"./chunk-AQDAG4C2.js";import{a as K,b as F,c as w,d as D,e as X,f as Y}from"./chunk-TT3E6PQD.js";import{a as Q,i as W}from"./chunk-WNVFIGRJ.js";import"./chunk-BYK2LYTJ.js";import"./chunk-SOUDSSPT.js";import"./chunk-YN3ICWDL.js";import{b as A,c as H,f as U}from"./chunk-JXNVBN57.js";import"./chunk-4JRWSVEX.js";import{b as S,c as l}from"./chunk-FJD4SS3V.js";import"./chunk-TKNWVBCA.js";import"./chunk-V454E5QD.js";import"./chunk-4DDSFSZM.js";import{a as Z}from"./chunk-I2CW5RII.js";import"./chunk-EHER635N.js";import"./chunk-D3V43LVN.js";import{a as V}from"./chunk-M5TAP4VX.js";import"./chunk-X4YGTLGV.js";import"./chunk-BBW4QHNN.js";import{b as j,d as s}from"./chunk-CL7MNENB.js";import"./chunk-5ZVMZG6E.js";import"./chunk-33HWVBTX.js";import{a as T,b as z,f as E,i as $}from"./chunk-ORNWO27Z.js";var e=E($());var m=E($());var t=E($());var Me=({teamName:p,uuid:b,displayName:c,displayEmail:y,invitationEmail:g,invitationName:f,user:d,role:i,isCurrentMember:v,onRemove:a})=>{let[o,h]=ie({triggerOnce:!1,rootMargin:"50% 0% 50%"});return t.default.createElement(F,{key:b,ref:o},h?t.default.createElement(t.default.Fragment,null,t.default.createElement(w,{py:"15px"},t.default.createElement(S,{alignItems:"center"},t.default.createElement(l,{mr:"15px"},t.default.createElement(_,{size:"medium",name:(d==null?void 0:d.name)||f,url:d==null?void 0:d.avatar,variant:i})),t.default.createElement(l,{alignItems:"center",flex:1,style:{overflow:"hidden"},mr:3},t.default.createElement(A,{fontSize:"16px"},c),y?t.default.createElement(A,{as:"div",fontSize:"14px",color:"grey300"},y):null))),t.default.createElement(w,{textAlign:"left",alignItems:"center"},t.default.createElement(S,{justifyContent:"flex-start"},a&&t.default.createElement(t.default.Fragment,null,t.default.createElement(s,{id:`team.members.prompts.${v?"leave":"removeUser"}`,values:{member:c,team:p}},k=>t.default.createElement(ne,{"data-testid":`remove-${b}`,p:"0px",label:t.default.createElement(s,{id:`team.members.actions.${v?"leave":"remove"}`}),onClick:()=>{let M=v?p:c;prompt(k)===M&&a(b)}})))))):t.default.createElement(w,{colSpan:"5",py:"37px"}))},pe=Me;var he=({members:p,isAdmin:b,currentMemberUuid:c,onRemove:y,teamName:g})=>{let[f,d]=(0,m.useState)("displayName"),[i,v]=(0,m.useState)("asc"),a=p.slice().sort((o,h)=>se(o[f],h[f],i));return m.default.createElement(l,{pb:"60px","data-testid":"teamMembers"},m.default.createElement(Y,{bleed:0},m.default.createElement(K,null,m.default.createElement(F,null,["displayName"].map(o=>m.default.createElement(D,{key:o,py:"15px",width:"95%"},m.default.createElement(Q,{attribute:o,onUpdateSortBy:d,onUpdateSortDirection:v,sortBy:f,sortDirection:i},m.default.createElement(s,{id:`memberManagement.table.${o}`})))),m.default.createElement(D,{width:"5%",textAlign:"left"},m.default.createElement(s,{id:"memberManagement.table.actions"})))),(a==null?void 0:a.length)?m.default.createElement(X,null,a.map(o=>m.default.createElement(pe,T({key:o.uuid,teamName:g,onRemove:(o.uuid===c||b)&&y,isCurrentMember:o.uuid===c},o)))):null))},de=he;var Be=({match:{params:{teamId:p}}})=>{let b=j(),{membership:c,can:y}=Z({teamId:p}),{feedback:g,setFeedback:f,clearFeedback:d}=re(),[i,v]=(0,e.useState)(null),[a,o]=(0,e.useState)([]),[h,k]=(0,e.useState)(!1),{loading:M,data:q}=V(ae,{variables:{teamId:p},fetchPolicy:"cache-and-network",onError:r=>{f({type:"error",message:I(r),location:"teamMembersList"})}}),{team:ue}=q||{},{name:B,members:C,organisation:fe}=ue||{},{slug:P,name:be}=fe||{},{uuid:L,role:ce}=c||{},[ge]=G(le,{onCompleted:({updateMember:r})=>{let{uuid:n,user:u,invitationName:x}=r||{};if(n===L)window.location="/home";else{let ye=a.filter(ve=>ve.uuid!==n);o(ye),f({type:"success",location:"teamMembersList",message:e.default.createElement(s,{id:"team.members.notifications.removeSuccess",values:{member:e.default.createElement(U,{color:"green400"},(u==null?void 0:u.name)||x,"\u2019s"),team:B}})})}},onError:r=>{f({type:"error",message:I(r),location:"teamMembersList"})}});(0,e.useEffect)(()=>{if(!M){let r=(C||[]).map(n=>{var u,x;return z(T({},n),{displayName:n.uuid===L?b.formatMessage({id:"currentUser.displayName"}):((u=n.user)==null?void 0:u.name)||n.invitationName,displayEmail:y("readTeamMembers")?((x=n.user)==null?void 0:x.email)||n.invitationEmail:null})});o(r),k(i==null?void 0:i.length)}},[M,i]);let xe=r=>{let n=C.find(u=>u.uuid===r);if(n){let u=n.teams.filter(({slug:x})=>x!==p).map(({slug:x})=>x);ge({variables:{organisation:P,uuid:r,attributes:{teams:u}}})}};if(M)return e.default.createElement(J,null);let N=(i==null?void 0:i.length)?ee(a,i,{keys:["displayName","user.name","user.email","invitationName","invitationEmail"]}):a;return e.default.createElement(e.default.Fragment,null,e.default.createElement(oe,{id:"team.members.title",breadcrumbs:[B,be]}),e.default.createElement(O,{variant:"button"},e.default.createElement(l,{flex:1,mb:[4,0]},e.default.createElement(me,null,e.default.createElement(s,{id:"team.members.heading",values:{team:B}}))),y("updateOrganisations")?e.default.createElement(l,{pr:1,width:[1,"auto"]},e.default.createElement(W,{to:`/teams/${p}/team/add`},e.default.createElement(s,{id:"team.members.actions.invite",values:{team:B}}))):null),M?null:e.default.createElement(e.default.Fragment,null,e.default.createElement(S,{flexWrap:["wrap","nowrap"],alignItems:"center",justifyContent:"space-between",mx:4,mt:3},e.default.createElement(l,{flex:1,width:[1,"auto"]},e.default.createElement(H,{as:"h2",level:"sm",color:"grey400"},e.default.createElement(s,{id:`team.members.summary.${h?"filtered":"members"}`,values:{count:e.default.createElement(U,null,N.length," ",e.default.createElement(s,{id:`team.members.summary.${N.length===1?"singular":"plural"}`}))}}))),e.default.createElement(l,{width:[1,"auto"],mt:[2,0]},e.default.createElement(R,{width:1,type:"search",onChange:r=>v((r==null?void 0:r.length)?r:null),placeholder:b.formatMessage({id:"team.members.actions.search"}),loading:i&&M})))),g&&g.location==="teamMembersList"&&g.type==="success"&&e.default.createElement(te,T({"data-qa":"teamMembersList",p:null,pt:4,px:4,pb:0,duration:0,onDismiss:()=>d()},g)),e.default.createElement(l,{mx:4,mt:g.location==="teamMembersList"?3:"50px"},e.default.createElement(de,{members:N,teamId:p,orgId:P,currentMemberUuid:L,isAdmin:ce==="admin",teamName:B,onRemove:xe})))},tt=Be;export{tt as default};
//# sourceMappingURL=Members-UE62M2J4.js.map
