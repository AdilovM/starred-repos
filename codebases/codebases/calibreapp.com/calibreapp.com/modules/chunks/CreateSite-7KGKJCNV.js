import{a as W}from"./chunk-HVWSZP6M.js";import{b as te}from"./chunk-5AV6UUBC.js";import{b as X,e as Z}from"./chunk-T3M2VH6O.js";import{a as R,b as ee}from"./chunk-TIOT2YSZ.js";import"./chunk-KCN7NYIH.js";import"./chunk-YG5VU5UW.js";import"./chunk-CWNFCDZO.js";import"./chunk-ZNS7TFW4.js";import{a as Q}from"./chunk-IHTWZOQH.js";import"./chunk-OFY5O3WH.js";import{c as F,e as x,f as z,h as Y,i as J}from"./chunk-ECKCXZDJ.js";import"./chunk-5AD3ZUGZ.js";import"./chunk-2OWL4LTV.js";import"./chunk-62V4AEVH.js";import"./chunk-WDJIMBUZ.js";import"./chunk-ZK4YBVUK.js";import"./chunk-URMVBSCF.js";import{a as D}from"./chunk-RZQ4QVPP.js";import"./chunk-M3VXQ3H4.js";import{a as K}from"./chunk-UJ4RDOBF.js";import"./chunk-EWS3NXQH.js";import{c as $,d as A,j as H}from"./chunk-AQDAG4C2.js";import"./chunk-TT3E6PQD.js";import{c as O,d as U,i as j}from"./chunk-WNVFIGRJ.js";import"./chunk-BYK2LYTJ.js";import"./chunk-SOUDSSPT.js";import"./chunk-YN3ICWDL.js";import{c as T,e as w}from"./chunk-JXNVBN57.js";import"./chunk-4JRWSVEX.js";import{c as g}from"./chunk-FJD4SS3V.js";import"./chunk-TKNWVBCA.js";import"./chunk-V454E5QD.js";import"./chunk-4DDSFSZM.js";import{a as N}from"./chunk-M5TAP4VX.js";import"./chunk-X4YGTLGV.js";import"./chunk-BBW4QHNN.js";import{d as B}from"./chunk-CL7MNENB.js";import"./chunk-5ZVMZG6E.js";import"./chunk-33HWVBTX.js";import{a as i,b as E,c as M,f as V,i as q}from"./chunk-ORNWO27Z.js";var o=V(q());var e=V(q());var se=({orgId:d,onUpdate:c,onValidating:m})=>{let[a,l]=(0,e.useState)({0:{name:"Home"}}),p=n=>{let s=i(i({},a),n);l(s),c(s)},h=()=>{let n=`${Date.now()}${Object.keys(a).length}`,s=E(i({},a),{[n]:{}});l(s)};return e.default.createElement(e.default.Fragment,null,e.default.createElement(te,{orgId:d,onUpdate:p,onRemove:n=>{delete a[n],l(i({},a))},onValidating:m,pages:a}),e.default.createElement(U,{onClick:n=>{n.preventDefault(),h()}},"Add another page"))},ie=y=>{var f=y,{orgId:d,teamId:c,loading:m,locations:a,teams:l,onCreate:p}=f,h=M(f,["orgId","teamId","loading","locations","teams","onCreate"]);let n=(0,e.useRef)(),[s,b]=(0,e.useState)(h),[C,L]=(0,e.useState)(!1),{name:S,team:r,location:v,scheduleInterval:G,scheduleAnchor:I}=s,u=t=>{let k=i(i({},s),t);b(k)},P=t=>{t.preventDefault(),p(s)};return e.default.createElement($,null,e.default.createElement(H,null,e.default.createElement(g,{flex:1,mb:[4,0]},e.default.createElement(W,null,e.default.createElement(w,{to:`/teams/${c}`},"Sites"),e.default.createElement(B,{id:"site.new.title"}))),e.default.createElement(g,{pr:1,width:[1,"auto"]},e.default.createElement(O,{href:"/docs/get-started/guide"},e.default.createElement(B,{id:"site.actions.guide.new"})))),e.default.createElement("form",{onSubmit:P,ref:n,"data-qa":"pageForm"},e.default.createElement(A,null,e.default.createElement(F,{mb:0},e.default.createElement(x,{label:"Site name"},e.default.createElement(z,{"data-testid":"site-name",name:"site_name",defaultValue:S,required:!0,maxLength:120,onChange:t=>u({name:t}),placeholder:"Your site name"}))),e.default.createElement(se,{orgId:d,onUpdate:t=>u({pages:t}),onValidating:L})),e.default.createElement(A,null,e.default.createElement(g,{mb:3},e.default.createElement(T,{level:"sm"},e.default.createElement(B,{id:"site.agentSettings.title"}))),e.default.createElement(F,{mb:0},e.default.createElement(R,{location:v,locations:a,onChange:u}),e.default.createElement(ee,{scheduleInterval:G,scheduleAnchor:I,onChange:t=>b(i(i({},s),t))}))),e.default.createElement(A,null,e.default.createElement(g,{mb:3},e.default.createElement(T,{level:"sm"},e.default.createElement(B,{id:"site.settings.team.title"}))),e.default.createElement(F,{mb:0},e.default.createElement(x,{"data-testid":"site-team",labelid:"site.settings.team.label"},e.default.createElement(Y,{name:"site_team",options:(l||[]).map(({slug:t,name:k})=>({label:k,value:t})),defaultValue:r,onChange:t=>u({team:t}),loading:m||!l.length||!r}))),e.default.createElement(g,{mb:4},e.default.createElement(x,null,e.default.createElement(J,{name:"site_notifications",onChange:t=>u({notifications:t})},e.default.createElement("span",{"data-qa":"site-notifications"},"Send me\xA0"),e.default.createElement(w,{href:"/insights",target:"_blank"},"Insights Performance Reports")))),e.default.createElement(j,{disabled:C||m||!S||!S.length,type:"submit"},"Start tracking"))))},oe=ie;var ae=o.default.lazy(()=>import("./Feedback-J4FBAYX2.js")),re=[{name:"Chrome Desktop",connection:"cable"},{name:"MotoG4, 3G connection",device:"MotorolaMotoG4",connection:"regular3G"},{name:"iPhone, 4G LTE",device:"iPhone8",connection:"LTE"}],le=({match:{params:{teamId:d}},history:c})=>{let[m,a]=(0,o.useState)(),[l,{loading:p}]=D(Z,{onCompleted:({createSite:{slug:r,team:{slug:v}}})=>{c.push(`/teams/${v}/${r}`)},onError:r=>{a({type:"error",message:Q(r)})}}),{data:h}=N(X,{variables:{teamId:d},fetchPolicy:"cache-and-network"}),{locations:y,team:f}=h||{},{name:n,organisation:s}=f||{},{slug:b,teamsList:{edges:C}}=s||{teamsList:{edges:[]}},L=(C||[]).map(({node:r})=>r),S=r=>{if(p)return;let{name:v,team:G,pages:I,location:u,scheduleInterval:P,scheduleAnchor:t,notifications:k}=r,_=["budget_alerts","snapshot_alerts"];k&&(_.push("weekly_insights"),_.push("monthly_insights"));let ne=["off","hourly"].includes(P)?null:parseInt(t);l({variables:{orgId:b,attributes:{name:v,team:G,testProfiles:re,pages:Object.values(I),eventSubscriptions:_,agentSettings:{location:u,scheduleInterval:P,scheduleAnchor:ne}}}})};return o.default.createElement(o.default.Fragment,null,o.default.createElement(K,{id:"site.new.title",breadcrumbs:[n]}),!m||o.default.createElement(o.Suspense,{fallback:o.default.createElement("div",null)},o.default.createElement(ae,i({},m))),o.default.createElement(oe,{orgId:b,teamId:d,locations:y,teams:L,team:d,onCreate:S,location:"NorthVirginia",scheduleInterval:"every_x_hours",scheduleAnchor:6}))},xe=le;export{xe as default};
//# sourceMappingURL=CreateSite-7KGKJCNV.js.map
