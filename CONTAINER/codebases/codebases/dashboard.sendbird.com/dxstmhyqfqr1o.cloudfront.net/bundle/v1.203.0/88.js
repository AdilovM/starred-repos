(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{njfb:function(e,t,a){"use strict";a.r(t);a("3bBZ");var n=a("q1tI"),i=a("dDsW"),r=a("/MKj"),s=a("JsuU"),c=a("b2r9"),o=a("cAlb"),l=a("26RP"),d=a("6889"),b=a("vOnD"),j=a("E+oP"),u=a.n(j),m=a("W7Pl");var h=a("v4r+");var p=a("eWwy"),g=a("HVr3"),O=a("sGiN"),f=a("nKUr");const x=b.default.div.withConfig({displayName:"cardForm__FormBox",componentId:"ztq2o9-0"})(["",";margin-bottom:20px;",""],Object(g.d)(),({grid:e})=>"half"===e?Object(b.css)(["display:grid;grid-template-columns:1fr 1fr;grid-column-gap:16px;"," + ","{margin-top:0;}"],d.U,d.U):""),y=b.default.form.withConfig({displayName:"cardForm__StyledCardForm",componentId:"ztq2o9-1"})([".stripeInput{display:block;width:100%;color:",";-webkit-appearance:none;height:40px;line-height:38px;font-size:14px;cursor:auto;will-change:height;padding:10px 16px;border-width:1px;border-style:solid;border-color:",";border-image:initial;border-radius:4px;outline:none;background:white;transition:height 0.2s cubic-bezier(0.4,0,0.2,1) 0s;&.StripeElement--focus{border-color:",";}}"],Object(s.cssVariables)("neutral-10"),Object(s.cssVariables)("neutral-3"),Object(s.cssVariables)("purple-7")),C=b.default.div.withConfig({displayName:"cardForm__CheckboxLabel",componentId:"ztq2o9-2"})(["padding-left:8px;"]),S=b.default.div.withConfig({displayName:"cardForm__Inform",componentId:"ztq2o9-3"})(["",";color:",";margin-top:16px;"],s.Body["body-short-01"],Object(s.cssVariables)("neutral-7")),_={style:{base:{fontSize:"14px",color:Object(s.cssVariables)("neutral-10"),letterSpacing:"0",fontFamily:s.typeface.system,"::placeholder":{color:Object(s.cssVariables)("neutral-7")}},invalid:{color:Object(s.cssVariables)("red-5")}}},v=({isLoading:e,handleSubmit:t,handleDialogCancel:a,submitText:i})=>{const c=Object(p.useStripe)(),b=Object(p.useElements)(),{intent_client_secret:j}=(()=>{const e=Object(r.g)(e=>e.organizations.current.uid),[{status:t,data:a,error:i},c]=Object(m.g)(async()=>Object(o.initCardRegistration)(e),[e]);return Object(n.useEffect)(()=>{c()},[c]),Object(n.useEffect)(()=>{i&&s.toast.error({message:Object(l.b)(i)})},[i]),{isLoading:"loading"===t,intent_client_secret:(null==a?void 0:a.data.intent_client_secret)||""}})(),[h,g]=Object(n.useState)(!1),v=Object(n.useCallback)(async e=>{if(!e.agree)return s.toast.warning({message:O.g}),!1;const a={};if(e.city&&(a.city=e.city),e.country&&(a.country=e.country),e.line1&&(a.line1=e.line1),c&&b){g(!0);const n=b.getElement(p.CardElement);if(n){const{setupIntent:i,error:r}=await c.confirmCardSetup(j,{payment_method:{card:n,billing_details:{name:e.name,...u()(a)?{}:{address:a}}}});r&&s.toast.error({message:Object(l.b)(r)}),i&&await t(i)}g(!1)}},[c,b,j,t]),w=Object(s.useForm)({onSubmit:v}),F=Object(s.useField)("name",w,{defaultValue:"",validate:e=>e.trim()?"":"Please enter your name."}),k=Object(s.useField)("line1",w,{defaultValue:""}),V=Object(s.useField)("city",w,{defaultValue:""}),T=Object(s.useField)("country",w,{defaultValue:""}),U=Object(s.useField)("agree",w,{defaultValue:!1,isControlled:!0});return Object(f.jsxs)(y,{onSubmit:w.onSubmit,"data-test-id":"CardForm",children:[Object(f.jsxs)(d.R,{children:[Object(f.jsxs)(x,{children:[Object(f.jsxs)(d.U,{children:[Object(f.jsx)(d.T,{children:"Card"}),Object(f.jsx)(p.CardElement,{className:"stripeInput",options:{..._,hidePostalCode:!0}})]}),Object(f.jsxs)(d.U,{children:[Object(f.jsx)(d.T,{children:"Full name"}),Object(f.jsx)(d.g,{type:"text",ref:F.ref,name:F.name,required:!0,"data-test-id":"FullNameField"})]})]}),Object(f.jsx)(x,{children:Object(f.jsxs)(d.U,{children:[Object(f.jsx)(d.T,{children:"Address (optional)"}),Object(f.jsx)(d.g,{type:"text",ref:k.ref,name:k.name})]})}),Object(f.jsxs)(x,{grid:"half",children:[Object(f.jsxs)(d.U,{children:[Object(f.jsx)(d.T,{children:"City (optional)"}),Object(f.jsx)(d.g,{type:"text",ref:V.ref,name:V.name})]}),Object(f.jsxs)(d.U,{children:[Object(f.jsx)(d.T,{children:"Country (optional)"}),Object(f.jsx)(d.g,{type:"text",ref:T.ref,name:T.name})]})]}),Object(f.jsxs)(d.U,{children:[Object(f.jsx)(s.Checkbox,{ref:U.ref,name:U.name,checked:U.value,onChange:U.onChange,label:Object(f.jsxs)(C,{children:["I agree to Sendbird's"," ",Object(f.jsx)("a",{href:"https://sendbird.com/terms-of-service",target:"_blank",children:"Terms of Service"})," ","and"," ",Object(f.jsx)("a",{href:"https://sendbird.com/privacy",target:"_blank",children:"Privacy Policy"}),"."]})}),Object(f.jsx)(S,{children:"*You may receive a pending charge of USD 1.00 or less to verify that your card is valid."})]})]}),Object(f.jsxs)(d.Q,{children:[Object(f.jsx)(d.n,{type:"button",onClick:a,children:"Cancel"}),Object(f.jsx)(d.x,{type:"submit",isFetching:h||e,disabled:h||e,children:i})]})]})},w=({isLoading:e,handleSubmit:t,handleDialogCancel:a,submitText:n="Save"})=>{const i=(async()=>await Object(h.a)("pk_live_SLmfuYTWTQn6u5irDrXhASnO"))();return Object(f.jsx)(p.Elements,{stripe:i,children:Object(f.jsx)(v,{isLoading:e,handleSubmit:t,handleDialogCancel:a,submitText:n})})},F=r.g;t.default=({dialogProps:{onSuccess:e,onClose:t},onClose:a})=>{const b=Object(i.a)(),[j,u]=Object(n.useState)(!1),m=F(e=>e.organizations.current.uid),h=Object(r.f)(),p=()=>{null==t||t(),a()};return Object(f.jsx)(d.K,{size:"small",onClose:p,title:"Credit card information",body:Object(f.jsx)(w,{isLoading:j,handleSubmit:async t=>{if(u(!0),t.payment_method){try{await Object(o.registerCard)(m,t.payment_method),h(c.b.fetchCardInfoRequest({organization_uid:m})),s.toast.success({message:b.formatMessage({id:"common.changesSaved"})}),p(),null==e||e()}catch(e){s.toast.error({message:Object(l.b)(e)})}u(!1)}else s.toast.warning({message:"Failed to setup payment method"})},handleDialogCancel:p,submitText:"Update"})})}}}]);
//# sourceMappingURL=88.js.map?v=06c5e25806d79e6d037c