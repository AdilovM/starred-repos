import{a as V}from"./chunk-ECNFHRET.js";import{d as G,e as M}from"./chunk-ZNS7TFW4.js";import{a as Q}from"./chunk-W365GONS.js";import{b as D}from"./chunk-5AD3ZUGZ.js";import{a as O}from"./chunk-YOWIORHC.js";import{a as B}from"./chunk-2OWL4LTV.js";import{f as q}from"./chunk-SOUDSSPT.js";import{b as f}from"./chunk-JXNVBN57.js";import{b as w,c as I}from"./chunk-FJD4SS3V.js";import{d as _}from"./chunk-CL7MNENB.js";import{a as F}from"./chunk-5ZVMZG6E.js";import{a as r,b as a,f as p,i as y}from"./chunk-ORNWO27Z.js";var e=p(y()),E=p(B());var b=p(y()),u=p(F());var l=p(y()),c=p(F()),j=p(B());var x=class extends l.default.Component{constructor(s){super(s);this.handleToggle=this.handleToggle.bind(this)}handleToggle(s){this.props.onChange(s.target.value)}get previewImage(){return this.props.previewImage?l.default.createElement("img",{src:this.props.previewImage,width:"45",className:"preview-image m--r1"}):null}render(){let s=(0,j.default)("checkbox",{active:this.props.checked},this.props.className);return l.default.createElement("label",{className:s},l.default.createElement("input",{name:this.props.group,type:"radio",checked:this.props.checked,onChange:this.handleToggle,value:this.props.value}),this.previewImage,this.props.checked?l.default.createElement(f,{fontSize:"sm",fontWeight:"2",color:"blue300"},this.props.label):l.default.createElement(f,{fontSize:"sm",color:"blue300"},this.props.label))}};x.propTypes={label:c.default.string.isRequired,value:c.default.oneOfType([c.default.string,c.default.number]).isRequired,onChange:c.default.func.isRequired};var z=x;var C=class extends b.default.Component{constructor(s){super(s);this.state={groupName:`radioButtonGroup-${+new Date}`}}render(){let{className:s,onChange:i,items:o,checked:g}=this.props,{groupName:d}=this.state;return b.default.createElement("div",null,o.map((m,v)=>b.default.createElement("div",{key:v,className:"m--b1"},b.default.createElement(z,{group:d,checked:m.value===g,className:s,onChange:i,value:m.value,label:m.label,previewImage:m.previewImage}))))}};C.propTypes={onChange:u.default.func.isRequired,items:u.default.arrayOf(u.default.shape({label:u.default.string.isRequired,value:u.default.isRequired})).isRequired};var A=C;var W=class extends e.default.Component{constructor(s){super(s);this.state={pagesFilter:{},panelIsOpen:!1},this.toggleFilterVisibility=this.toggleFilterVisibility.bind(this),this.handlePageChange=this.handlePageChange.bind(this),this.closeMenu=this.closeMenu.bind(this),this.handleSearch=this.handleSearch.bind(this)}componentDidMount(){document.body.addEventListener("click",this.closeMenu,!1)}componentWillUnmount(){document.body.removeEventListener("click",this.closeMenu)}closeMenu(s){let i=[],o=s.target;for(;o.parentNode;)i.unshift(o.parentNode),o=o.parentNode;i.reverse().some(d=>{if(d.classList)return d.classList.contains("dropdown")})||this.setState({panelIsOpen:!1})}toggleFilterVisibility(){this.setState({panelIsOpen:!this.state.panelIsOpen})}handlePageChange(s){this.setState({page:s},()=>{this.toggleFilterVisibility(),this.props.onApply.call(this,{page:this.state.page})})}handleSearch(s){this.setState({pagesFilter:{nameContains:s}})}render(){let{orgId:s,teamId:i,siteId:o,selectedPage:g}=this.props,{pagesFilter:d}=this.state,m=(0,E.default)("dropdown",{"dropdown--isActive":this.state.panelIsOpen});return e.default.createElement("div",{className:m,style:{display:"inline-block"}},e.default.createElement("button",{className:"dropdown__trigger type-semibold type-c-dark-grey",onClick:this.toggleFilterVisibility,style:{cursor:"pointer"}},g&&O(g.name,25),e.default.createElement("div",{className:"dropdown__chevron"},e.default.createElement(q,null))),e.default.createElement("div",{className:"dropdown__target"},e.default.createElement("div",{className:"dropdown__header"},e.default.createElement(D,{placeholder:"Search for page",onChange:this.handleSearch})),e.default.createElement("div",{className:"dropdown__content"},this.state.panelIsOpen&&e.default.createElement(e.Suspense,{fallback:e.default.createElement("div",null)},e.default.createElement(Q,{query:i?M:G,variables:{orgId:s,teamId:i,siteId:o,pagesFilter:d,count:20},fetchPolicy:"network-only"},({loading:v,data:n,fetchMore:U})=>{var T,P;if(v||!n)return null;let $=((T=n==null?void 0:n.team)==null?void 0:T.site)||((P=n==null?void 0:n.organisation)==null?void 0:P.site),{pagesList:{edges:H,pageInfo:L}}=$,k=H.map(t=>{let{canonical:h,name:K,uuid:X,previewImage:S}=t.node;return{canonical:h,label:K,value:X,previewImage:S?S.url:null}}),J=()=>{U({variables:{cursor:L.endCursor},updateQuery:(t,{fetchMoreResult:h})=>i?Object.assign({},t,{team:a(r({},t.team),{bustCache:1,site:a(r({},t.team.site),{pagesList:a(r({},t.team.site.pagesList),{edges:[...t.team.site.pagesList.edges,...h.team.site.pagesList.edges],pageInfo:h.team.site.pagesList.pageInfo})})})}):Object.assign({},t,{organisation:a(r({},t.organisation),{bustCache:1,site:a(r({},t.organisation.site),{pagesList:a(r({},t.organisation.site.pagesList),{edges:[...t.organisation.site.pagesList.edges,...h.organisation.site.pagesList.edges],pageInfo:h.organisation.site.pagesList.pageInfo})})})})})};return e.default.createElement("div",{className:"dropdown__list"},k.length&&e.default.createElement(A,{onChange:this.handlePageChange,checked:g.uuid,items:k})||e.default.createElement(w,null,e.default.createElement(I,{px:1},e.default.createElement(f,null,e.default.createElement(_,{id:"pages.empty"})))),e.default.createElement(w,null,e.default.createElement(I,{mx:"auto"},e.default.createElement(V,{pageInfo:L,onNext:J}))))})))))}},de=W;export{A as a,de as b};
//# sourceMappingURL=chunk-RQDYQJNL.js.map
